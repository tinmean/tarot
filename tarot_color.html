<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>å¡”ç¾…ç‰ŒæŠ½ç‰Œç¨‹å¼ï¼ˆè‡ªå®šç¾©åœ–æºç‰ˆï¼‰</title>
  <style>
    :root {
      --bg-color: #2c3e50;
      --text-color: #ecf0f1;
      --card-bg: #fff;
    }

    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: var(--bg-color);
      padding: 20px;
      padding-bottom: 60px; /* é ç•™ footer ç©ºé–“ */
      margin: 0;
      color: var(--text-color);
    }

    h1 { margin-bottom: 12px; font-size: 1.5rem; color: #f1c40f; text-shadow: 1px 1px 2px #000; }

    .controls {
      margin: 14px 0 18px 0;
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      align-items: center;
      background: rgba(0,0,0,0.2);
      padding: 10px;
      border-radius: 12px;
    }

    fieldset {
      border: 1px solid #7f8c8d;
      padding: 8px 12px;
      border-radius: 8px;
      background: rgba(255,255,255,0.05);
      margin: 0;
    }

    legend { padding: 0 6px; color: #f1c40f; font-size: 14px; font-weight: bold; }

    button {
      padding: 10px 16px;
      font-size: 16px;
      cursor: pointer;
      background: #f1c40f;
      color: #2c3e50;
      border: none;
      border-radius: 8px;
      font-weight: bold;
      transition: all 0.2s;
    }
    button:hover { background: #f39c12; transform: scale(1.05); }
    button:active { transform: scale(0.95); }

    input[type="text"], select {
      padding: 8px 10px;
      border-radius: 8px;
      border: 1px solid #7f8c8d;
      background: #ecf0f1;
      color: #333;
      font-size: 14px;
    }

    /* ===== ç‰Œé™£ Grid ç³»çµ± ===== */
    .cards {
      display: grid;
      gap: 16px;
      margin-top: 20px;
      width: 100%;
      min-height: 400px;
    }

    .spread-one { grid-template-columns: 1fr; justify-items: center; }
    .spread-three { grid-template-columns: repeat(3, 1fr); }
    .spread-five { grid-template-columns: repeat(5, 1fr); }
    
    /* åäºŒå¼µåœ“ç’°æ’åˆ— */
    .spread-twelve.circle {
      position: relative;
      display: block;
      width: 760px; 
      height: 760px;
      margin: 0 auto;
      transform-origin: top center;
    }
    .spread-twelve.circle .card {
      position: absolute;
      width: 100px;
      height: 170px;
      transform: translate(-50%, -50%);
      margin: 0;
    }
    .spread-twelve.circle .card.center {
      left: 50% !important;
      top: 50% !important;
      width: 120px;
      height: 204px;
      z-index: 5;
      box-shadow: 0 0 25px rgba(241, 196, 15, 0.4);
    }

    .spread-five.choice {
      grid-template-columns: repeat(3, 1fr);
      grid-template-areas: "a1 . b1" "a2 . b2" ". c .";
    }
    .spread-five.choice .c1 { grid-area: a1; }
    .spread-five.choice .c2 { grid-area: a2; }
    .spread-five.choice .c3 { grid-area: b1; }
    .spread-five.choice .c4 { grid-area: b2; }
    .spread-five.choice .c5 { grid-area: c; }

    .spread-celtic {
      grid-template-columns: repeat(6, 1fr);
      grid-template-areas: ". . c5 . . c10" ". c4 c2 c6 . c9" ". . c1 . . c8" ". . c3 . . c7";
      align-items: center;
      justify-items: center;
    }
    .spread-celtic .c1 { grid-area: c1; z-index: 1; }
    .spread-celtic .c2 { grid-area: c2; z-index: 2; transform: rotate(90deg); margin-top: 0; }
    .spread-celtic .c3 { grid-area: c3; }
    .spread-celtic .c4 { grid-area: c4; }
    .spread-celtic .c5 { grid-area: c5; }
    .spread-celtic .c6 { grid-area: c6; }
    .spread-celtic .c7 { grid-area: c7; }
    .spread-celtic .c8 { grid-area: c8; }
    .spread-celtic .c9 { grid-area: c9; }
    .spread-celtic .c10 { grid-area: c10; }

    /* ===== å¡ç‰‡æ¨£å¼ ===== */
    .card {
      background: var(--card-bg);
      border-radius: 10px;
      aspect-ratio: 3/5; 
      width: 100%;
      max-width: 160px;
      position: relative;
      cursor: pointer;
      transition: transform 0.3s, box-shadow 0.3s;
      box-shadow: 0 4px 10px rgba(0,0,0,0.3);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      overflow: hidden;
    }

    .card:hover {
      transform: translateY(-5px) scale(1.02);
      box-shadow: 0 8px 20px rgba(0,0,0,0.5);
      z-index: 10;
    }

    .card-img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: transform 0.5s ease;
      display: block;
    }

    /* é€†ä½è™•ç† */
    .card.reversed-card .card-img { transform: rotate(180deg); }

    /* ç´”æ–‡å­—æ¨¡å¼ï¼ˆåœ–ç‰‡è¼‰å…¥å¤±æ•—æ™‚é¡¯ç¤ºï¼‰ */
    .card-text-fallback {
      display: none;
      padding: 10px;
      text-align: center;
      width: 100%;
    }
    .card-name { font-size: 18px; font-weight: 700; color: #333; margin-bottom: 5px; }
    .orientation-text { font-size: 14px; color: #c0392b; font-weight: bold; }
    
    .card-label {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      background: rgba(0,0,0,0.7);
      color: #fff;
      font-size: 12px;
      padding: 4px;
      text-align: center;
      backdrop-filter: blur(2px);
    }
    .reversed-label { color: #ff7675; }

    .position-badge {
      position: absolute;
      top: 5px;
      right: 5px;
      background: #f1c40f;
      color: #2c3e50;
      font-size: 11px;
      font-weight: bold;
      padding: 2px 6px;
      border-radius: 4px;
      z-index: 2;
      box-shadow: 0 2px 4px rgba(0,0,0,0.3);
    }

    /* ===== Overlay ===== */
    .card-overlay {
      position: fixed; inset: 0; background: rgba(0,0,0,0.85);
      display: none; align-items: center; justify-content: center; z-index: 9999; padding: 20px;
      opacity: 0; transition: opacity 0.2s;
    }
    .card-overlay.active { display: flex; opacity: 1; }
    
    .overlay-card {
      display: flex; flex-direction: column; align-items: center;
      background: transparent; max-width: 90vw; max-height: 90vh;
    }
    
    .overlay-img-container {
      position: relative;
      max-height: 70vh;
      border-radius: 15px;
      overflow: hidden;
      box-shadow: 0 0 30px rgba(255,255,255,0.1);
    }
    .overlay-img { max-height: 70vh; max-width: 100%; display: block; }
    .overlay-info { margin-top: 15px; text-align: center; color: #fff; }
    .overlay-name { font-size: 24px; font-weight: bold; margin-bottom: 5px; }
    .overlay-detail { font-size: 16px; color: #bdc3c7; }

    /* ===== Footer Copyright ===== */
    footer {
      text-align: center;
      margin-top: 40px;
      padding-top: 20px;
      border-top: 1px solid #7f8c8d;
      font-size: 12px;
      color: #95a5a6;
    }
    footer a { color: #bdc3c7; text-decoration: none; }
    footer a:hover { text-decoration: underline; color: #ecf0f1; }

    @media (max-width: 768px) {
      body { padding: 10px; padding-bottom: 60px; }
      .card { max-width: 100%; }
      .spread-three, .spread-five, .spread-five.choice { grid-template-columns: repeat(3, 1fr); }
      .spread-celtic { display: flex; flex-wrap: wrap; justify-content: center; gap: 10px; }
      .spread-celtic .card { width: 30%; margin: 0; transform: none !important; }
      
      .spread-twelve.circle {
        width: 760px; position: relative; left: 50%; margin-left: -380px;
        transform: scale(0.42); margin-top: -160px; margin-bottom: -380px;
      }
    }
  </style>
</head>
<body>

<h1>ğŸ”® å¡”ç¾…ç‰ŒæŠ½ç‰Œï¼ˆè‡ªå®šç¾©åœ–æºç‰ˆï¼‰</h1>
<div class="subtle" style="color: #bdc3c7;">åœ–ç‰‡ä¾†æºï¼šæ‚¨çš„ GitHub Pages</div>

<div class="controls">
  <label style="width:100%">
    å•é¡Œç°¡è¿°ï¼š
    <input id="question" type="text" maxlength="20" placeholder="ä¾‹å¦‚ï¼šé€™é€±é‹å‹¢..." />
  </label>

  <label>
    ç‰Œé™£ï¼š
    <select id="spread">
      <option value="one">å–®å¼µç‰Œ</option>
      <option value="three" selected>ä¸‰å¼µç‰Œ</option>
      <option value="five">äº”å¼µç‰Œ</option>
      <option value="twelve">åäºŒå¼µç‰Œ</option>
      <option value="celtic">è³½çˆ¾ç‰¹åå­—</option>
    </select>
  </label>

  <label id="threeVariantLabel">
    é¡å‹ï¼š
    <select id="threeVariant">
      <option value="past_present_future" selected>éå»ï¼ç¾åœ¨ï¼æœªä¾†</option>
      <option value="situation_obstacle_advice">ç¾æ³ï¼å•é¡Œï¼å»ºè­°</option>
    </select>
  </label>

  <label id="fiveVariantLabel" style="display:none">
    é¡å‹ï¼š
    <select id="fiveVariant">
      <option value="wu_shi_lun" selected>ç„¡è¦–è«–</option>
      <option value="choice">äºŒæ“‡ä¸€</option>
      <option value="horseshoe">é¦¬è¹„éµ</option>
      <option value="blindspots">ç›²é»åˆ†æ</option>
    </select>
  </label>

  <label id="twelveVariantLabel" style="display:none">
    é¡å‹ï¼š
    <select id="twelveVariant">
      <option value="houses" selected>åäºŒå®®ä½</option>
      <option value="months">åäºŒå€‹æœˆ</option>
    </select>
  </label>
  
  <label id="twelveThemeLabel" style="display:none; color: #f1c40f;">
    <input type="checkbox" id="twelveTheme" checked /> ä¸­å¿ƒä¸»é¡Œç‰Œ
  </label>

  <fieldset>
    <legend>è¨­å®š</legend>
    <label><input type="checkbox" id="useMajor" checked /> å¤§ç‰Œ</label>
    <label><input type="checkbox" id="useMinor" checked /> å°ç‰Œ</label>
    <label><input type="checkbox" id="allowReversed" checked /> é€†ä½</label>
  </fieldset>

  <button id="drawBtn" type="button">âœ¨ é–‹å§‹æŠ½ç‰Œ</button>
</div>

<div id="result" class="cards"></div>

<!-- Overlay -->
<div id="cardOverlay" class="card-overlay" aria-hidden="true" onclick="closeOverlay()">
  <div class="overlay-card" onclick="event.stopPropagation()">
    <div class="overlay-img-container">
      <img id="overlayImg" class="overlay-img" src="" alt="card">
    </div>
    <div class="overlay-info">
      <div id="overlayName" class="overlay-name"></div>
      <div id="overlayDetail" class="overlay-detail"></div>
      <button onclick="closeOverlay()" style="margin-top:15px; background:rgba(255,255,255,0.2); color:#fff;">é—œé–‰</button>
    </div>
  </div>
</div>

<hr style="border-top:1px solid #7f8c8d; margin: 30px 0;">

<h3 style="color:#ecf0f1;">ğŸ“œ æ­·å²ç´€éŒ„</h3>
<div style="margin-bottom:6px;">
  <button id="copyHistoryBtn" type="button" style="background:#7f8c8d; font-size:14px; padding:6px 12px;">è¤‡è£½</button>
  <button id="clearHistoryBtn" type="button" style="background:#95a5a6; font-size:14px; padding:6px 12px;">æ¸…é™¤</button>
</div>
<textarea id="history" rows="6" style="width:100%; font-size:14px; line-height:1.5; background:#ecf0f1; color:#333;" readonly></textarea>

<footer>
  <p>Rider-Waite-Smith Tarot (1909) | Artwork by Pamela Colman Smith (Public Domain)</p>
  <p>Image Source: <a href="https://github.com/searge/tarot" target="_blank">searge/tarot</a> (Licensed under MIT/Public Domain)</p>
</footer>

<script>
  "use strict";

  // ===== è¨­å®šï¼šåœ–ç‰‡ä¾†æº =====
  // ä¿®æ­£ï¼šä½¿ç”¨ä½¿ç”¨è€…æŒ‡å®šçš„ GitHub Pages è·¯å¾‘
  // æ³¨æ„ï¼šGitHub Pages é è¨­ç¶²åŸŸç‚º github.ioï¼Œè€Œé github.com
  // è«‹ç¢ºèªæ‚¨çš„å€‰åº«åç¨±æ˜¯ tarotï¼Œä¸¦ä¸”åœ–ç‰‡æ”¾åœ¨ images è³‡æ–™å¤¾å…§
  const IMAGE_BASE_URL = "https://tinmean.github.io/tarot/images/";

  // ===== 1. è³‡æ–™åº«å»ºæ§‹ (é©é… Searge å‘½åè¦å‰‡) =====
  
  // å¤§ç‰Œï¼šar00.jpg ~ ar21.jpg
  const majorArcana = [
    "æ„šè€…","é­”è¡“å¸«","å¥³ç¥­å¸","çš‡å","çš‡å¸","æ•™çš‡","æˆ€äºº","æˆ°è»Š","åŠ›é‡","éš±è€…",
    "å‘½é‹ä¹‹è¼ª","æ­£ç¾©","å€’åŠäºº","æ­»ç¥","ç¯€åˆ¶","æƒ¡é­”","é«˜å¡”","æ˜Ÿæ˜Ÿ","æœˆäº®","å¤ªé™½","å¯©åˆ¤","ä¸–ç•Œ"
  ].map((name, i) => ({
    name: name,
    type: "å¤§é˜¿çˆ¾å…‹é‚£",
    file: "ar" + String(i).padStart(2, '0') + ".jpg"
  }));

  // å°ç‰Œï¼šæ¬Šæ–=wa, è–æ¯=cu, å¯¶åŠ=sw, éŒ¢å¹£=pe
  const suits = [
    { name: "æ¬Šæ–", code: "wa" },
    { name: "è–æ¯", code: "cu" },
    { name: "å¯¶åŠ", code: "sw" },
    { name: "éŒ¢å¹£", code: "pe" }
  ];
  
  const minorArcana = [];
  suits.forEach(suit => {
    // æ•¸å­—ç‰Œ 1~10 (01, 02... 10)
    for (let i = 1; i <= 10; i++) {
      const rank = i === 1 ? "Ace" : i;
      minorArcana.push({
        name: suit.name + rank,
        type: "å°é˜¿çˆ¾å…‹é‚£",
        file: suit.code + String(i).padStart(2, '0') + ".jpg"
      });
    }
    // å®®å»·ç‰Œï¼šPage(pa), Knight(kn), Queen(qu), King(ki)
    const courts = [
      { name: "ä¾è€…", suffix: "pa" },
      { name: "é¨å£«", suffix: "kn" },
      { name: "çš‡å", suffix: "qu" },
      { name: "åœ‹ç‹", suffix: "ki" }
    ];
    courts.forEach(c => {
      minorArcana.push({
        name: suit.name + c.name,
        type: "å®®å»·ç‰Œ",
        file: suit.code + c.suffix + ".jpg"
      });
    });
  });

  const SPREAD_CONFIG = {
    three: {
      past_present_future: ["éå»","ç¾åœ¨","æœªä¾†"],
      situation_obstacle_advice: ["ç¾æ³","å•é¡Œ","å»ºè­°"]
    },
    five: {
      wu_shi_lun: [null, null, null, null, null],
      choice: ["é¸é …A","è¶¨å‹¢A","é¸é …B","è¶¨å‹¢B","å»ºè­°"],
      horseshoe: ["éå»","ç¾åœ¨","éšœç¤™","å»ºè­°","çµæœ"],
      blindspots: ["è¡¨è±¡","äº‹å¯¦","å¿½ç•¥","èª¤åˆ¤","é—œéµ"]
    },
    twelve: {
      houses: ["1å®®:è‡ªæˆ‘","2å®®:è²¡é‹","3å®®:æºé€š","4å®®:å®¶åº­","5å®®:æˆ€æ„›","6å®®:å·¥ä½œ","7å®®:ä¼´ä¾¶","8å®®:ç”Ÿæ­»","9å®®:é€²ä¿®","10å®®:äº‹æ¥­","11å®®:äººéš›","12å®®:æ½›æ„è­˜"],
      months: ["ä¸€æœˆ","äºŒæœˆ","ä¸‰æœˆ","å››æœˆ","äº”æœˆ","å…­æœˆ","ä¸ƒæœˆ","å…«æœˆ","ä¹æœˆ","åæœˆ","åä¸€æœˆ","åäºŒæœˆ"]
    },
    celtic: ["1.ç¾æ³","2.é˜»ç¤™","3.æ½›æ„è­˜","4.éå»","5.ç›®æ¨™","6.æœªä¾†","7.è‡ªæˆ‘","8.ç’°å¢ƒ","9.å¸Œæœ›/ææ‡¼","10.çµæœ"]
  };

  // ===== å·¥å…·å‡½å¼ =====
  function secureShuffle(array) {
    for (let i = array.length - 1; i > 0; i--) {
      const randomBuffer = new Uint32Array(1);
      window.crypto.getRandomValues(randomBuffer);
      const j = randomBuffer[0] % (i + 1);
      [array[i], array[j]] = [array[j], array[i]];
    }
  }

  function degToRad(deg) { return deg * Math.PI / 180; }
  function getTimestamp() {
    const d = new Date();
    const pad = n => String(n).padStart(2, "0");
    return `${d.getMonth()+1}/${d.getDate()} ${pad(d.getHours())}:${pad(d.getMinutes())}`;
  }

  function getTwelveAngle(variant, index) {
    const step = 360 / 12;
    if (variant === "houses") return 180 - (index * step);
    return -90 + (index * step);
  }

  // ===== Overlay =====
  const overlay = document.getElementById("cardOverlay");
  const overlayImg = document.getElementById("overlayImg");
  const overlayName = document.getElementById("overlayName");
  const overlayDetail = document.getElementById("overlayDetail");

  function openOverlay(data) {
    overlayImg.src = data.imgSrc;
    overlayImg.style.transform = data.reversed ? "rotate(180deg)" : "none";
    overlayName.innerText = `${data.name} ${data.reversed ? '(é€†ä½)' : '(æ­£ä½)'}`;
    overlayDetail.innerText = `${data.type} / ${data.position || 'ç„¡ä½ç½®'}`;
    overlay.classList.add("active");
    overlay.setAttribute("aria-hidden", "false");
  }

  window.closeOverlay = function() {
    overlay.classList.remove("active");
    overlay.setAttribute("aria-hidden", "true");
  };

  // ===== ç¹ªè£½èˆ‡é‚è¼¯ =====
  function buildDeck(useMajor, useMinor) {
    let deck = [];
    if (useMajor) deck = deck.concat(majorArcana);
    if (useMinor) deck = deck.concat(minorArcana);
    return deck;
  }

  function renderCard(card, position, styleCallback) {
    const el = document.createElement("div");
    el.className = `card ${card.reversed ? 'reversed-card' : ''}`;
    
    // çµ„åˆå®Œæ•´åœ–ç‰‡ç¶²å€
    const fullImgUrl = IMAGE_BASE_URL + card.file;

    el.onclick = () => openOverlay({ ...card, position, imgSrc: fullImgUrl });

    // å¤±æ•—è™•ç†ï¼šå¦‚æœåœ–ç‰‡è¼‰å…¥å¤±æ•— (onerror)ï¼Œéš±è—åœ–ç‰‡ï¼Œé¡¯ç¤º fallback æ–‡å­—å€å¡Š
    el.innerHTML = `
      <div class="position-badge">${position || '#'}</div>
      
      <img src="${fullImgUrl}" 
           class="card-img" 
           alt="${card.name}"
           loading="lazy"
           onerror="console.log('Load failed:', this.src); this.style.display='none'; this.nextElementSibling.style.display='block';">
           
      <div class="card-text-fallback">
        <div class="card-name">${card.name}</div>
        <div class="orientation-text">${card.reversed ? 'é€†ä½' : 'æ­£ä½'}</div>
        <div style="font-size:12px; color:#666; margin-top:4px;">(åœ–ç‰‡è¼‰å…¥å¤±æ•—)</div>
      </div>

      <div class="card-label ${card.reversed ? 'reversed-label' : ''}">
        ${card.name} ${card.reversed ? '(é€†)' : ''}
      </div>
    `;

    if (styleCallback) styleCallback(el);
    return el;
  }

  function drawCards() {
    const spread = document.getElementById("spread").value;
    const useMajor = document.getElementById("useMajor").checked;
    const useMinor = document.getElementById("useMinor").checked;
    const allowReversed = document.getElementById("allowReversed").checked;
    const question = document.getElementById("question").value.trim();

    if (!useMajor && !useMinor) return alert("è«‹è‡³å°‘é¸æ“‡ä¸€ç¨®ç‰Œçµ„ï¼");

    const deck = buildDeck(useMajor, useMinor);
    secureShuffle(deck);

    let positions = [];
    let isTwelve = false;

    if (spread === "one") positions = [null];
    else if (spread === "three") positions = SPREAD_CONFIG.three[document.getElementById("threeVariant").value];
    else if (spread === "five") positions = SPREAD_CONFIG.five[document.getElementById("fiveVariant").value];
    else if (spread === "twelve") {
      positions = SPREAD_CONFIG.twelve[document.getElementById("twelveVariant").value];
      isTwelve = true;
    } else if (spread === "celtic") {
      positions = SPREAD_CONFIG.celtic;
    }

    const hasTheme = isTwelve && document.getElementById("twelveTheme").checked;
    const totalNeeded = positions.length + (hasTheme ? 1 : 0);

    if (deck.length < totalNeeded) return alert(`ç‰Œæ•¸ä¸è¶³ï¼`);

    const container = document.getElementById("result");
    container.innerHTML = "";
    container.className = "cards spread-" + spread;
    if (spread === "five" && document.getElementById("fiveVariant").value === "choice") container.classList.add("choice");
    if (isTwelve) container.classList.add("circle");

    let cardIdx = 0;
    let resultText = [];

    if (hasTheme) {
      const c = deck[cardIdx++];
      c.reversed = allowReversed && (window.crypto.getRandomValues(new Uint8Array(1))[0] < 128);
      resultText.push(`[ä¸»é¡Œ:${c.name}${c.reversed?'(é€†)':''}]`);
      const el = renderCard(c, "æ ¸å¿ƒä¸»é¡Œ");
      el.classList.add("center");
      container.appendChild(el);
    }

    positions.forEach((posName, i) => {
      const c = deck[cardIdx++];
      c.reversed = allowReversed && (window.crypto.getRandomValues(new Uint8Array(1))[0] < 128);
      resultText.push(`${posName || (i+1)}:${c.name}${c.reversed?'(é€†)':''}`);

      const el = renderCard(c, posName, (div) => {
        if (spread === "five" && document.getElementById("fiveVariant").value === "choice") div.classList.add("c"+(i+1));
        if (spread === "celtic") div.classList.add("c"+(i+1));
        
        if (isTwelve) {
          const angle = getTwelveAngle(document.getElementById("twelveVariant").value, i);
          const r = 300;
          const x = 380 + r * Math.cos(degToRad(angle));
          const y = 380 + r * Math.sin(degToRad(angle));
          div.style.left = x + "px";
          div.style.top = y + "px";
        }
      });
      container.appendChild(el);
    });

    const historyLine = `ã€${getTimestamp()}ã€‘${question ? `[${question}] ` : ''}${resultText.join(" / ")}`;
    const historyArea = document.getElementById("history");
    historyArea.value = historyLine + "\n" + historyArea.value;
    
    document.cookie = "tarot_history=" + encodeURIComponent(historyArea.value) + "; max-age=" + (86400*30);
  }

  // ===== UI äº‹ä»¶ =====
  function updateUI() {
    const val = document.getElementById("spread").value;
    document.getElementById("threeVariantLabel").style.display = val === "three" ? "inline-flex" : "none";
    document.getElementById("fiveVariantLabel").style.display = val === "five" ? "inline-flex" : "none";
    document.getElementById("twelveVariantLabel").style.display = val === "twelve" ? "inline-flex" : "none";
    document.getElementById("twelveThemeLabel").style.display = val === "twelve" ? "inline-flex" : "none";
  }

  document.getElementById("spread").addEventListener("change", updateUI);
  document.getElementById("drawBtn").addEventListener("click", drawCards);
  document.getElementById("copyHistoryBtn").addEventListener("click", () => {
    document.getElementById("history").select();
    document.execCommand("copy");
  });
  document.getElementById("clearHistoryBtn").addEventListener("click", () => {
    if(confirm("ç¢ºå®šæ¸…ç©ºï¼Ÿ")) {
      document.getElementById("history").value = "";
      document.cookie = "tarot_history=; max-age=0";
    }
  });

  const match = document.cookie.match(/tarot_history=([^;]+)/);
  if (match) document.getElementById("history").value = decodeURIComponent(match[1]);

  updateUI();
</script>
</body>
</html>